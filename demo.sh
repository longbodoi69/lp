#!/system/bin/sh
dev="LongPhan"
refresh_rate=$(dumpsys SurfaceFlinger | grep -m 1 "refresh-rate" | awk '{printf("%d", $3)}')
ram_info=$(cat /proc/meminfo | grep -E "MemTotal|MemAvailable" | \
awk 'NR==1{total=$2} NR==2{available=$2} END{printf "%.2f / %.2f GB", available/1024/1024, total/1024/1024}')
storage=$(df /data | awk 'NR==2 { total=($2+$3)/1024/1024; used=$3/1024/1024; printf "%.2f / %.0f GB", used, total }')
ping=$(ping -c 1 8.8.8.8 | grep 'time=' | awk -F'time=' '{print $2}' | cut -d' ' -f1)
cores=$(grep -c ^processor /proc/cpuinfo)
brand=$(getprop ro.product.brand)
android=$(getprop ro.build.version.release)
bit=$(uname -m)

echo "┌────────────────────────────────────────┐"
echo "│     ⚙️ ANDROID OPTIMIZER LITE v2.0    │"
echo "├────────────────────────────────────────┤"
printf "│ 🕶️ Dev      : %-27s│\n" "$dev"
printf "│ 📦 Module   : %-27s│\n" "Demo Booster"
printf "│ 🔋 Status   : %-27s│\n" "No Root"
printf "│ 📱 Brand    : %-27s│\n" "$brand"
printf "│ 💿 Android  : %-27s│\n" "$android"
printf "│ 🔧 BitCheck : %-27s│\n" "$bit"
echo "├────────────────────────────────────────┤"
echo "│ [ SPEED TOUCH ]     [ CLEAN CACHE ]      │"
echo "│ [ GPU BOOST ]     [ BUILD LOGS ]  │"
echo "├────────────────────────────────────────┤"
printf "│ 📊 CPU      : %-27s│\n" "$cores cores"
printf "│ 🧠 RAM      : %-27s│\n" "$ram_info"
printf "│ 💾 Storage  : %-27s│\n" "$storage"
printf "│ 🌐 Network  : %-27s│\n" "$ping ms"
printf "│ ⚡ Screen   : %-27s│\n" "$refresh_rate Hz"
echo "└────────────────────────────────────────┘"

apply_fps() {
    local name="debug.hwui.fps_divisor"
    local value="1"
    setprop "$name" "$value"
}> /dev/null 2>&1
tweaks() {
    disable_log=(
        "log.tag.AF::MmapTrack VERBOSE"
        "log.tag.AF::OutputTrack VERBOSE"
        "log.tag.AF::PatchRecord VERBOSE"
        "log.tag.AF::PatchTrack VERBOSE"
        "log.tag.AF::RecordHandle VERBOSE"
        "log.tag.AF::RecordTrack VERBOSE"
        "log.tag.AF::Track VERBOSE"
        "log.tag.AF::TrackBase VERBOSE"
        "log.tag.AF::TrackHandle VERBOSE"
        "log.tag.APM-KpiMonitor VERBOSE"
        "log.tag.APM-ServiceJ VERBOSE"
        "log.tag.APM-SessionJ VERBOSE"
        "log.tag.APM-SessionN VERBOSE"
        "log.tag.APM-Subscriber VERBOSE"
        "log.tag.APM::AudioCollections VERBOSE"
        "log.tag.APM::AudioInputDescriptor VERBOSE"
        "log.tag.APM::AudioOutputDescriptor VERBOSE"
        "log.tag.APM::AudioPatch VERBOSE"
        "log.tag.APM::AudioPolicyEngine VERBOSE"
        "log.tag.APM::AudioPolicyEngine::Base VERBOSE"
        "log.tag.APM::AudioPolicyEngine::Config VERBOSE"
        "log.tag.APM::AudioPolicyEngine::ProductStrategy VERBOSE"
        "log.tag.APM::AudioPolicyEngine::VolumeGroup VERBOSE"
        "log.tag.APM::Devices VERBOSE"
        "log.tag.APM::IOProfile VERBOSE"
        "log.tag.APM::Serializer VERBOSE"
        "log.tag.APM::VolumeCurve VERBOSE"
        "log.tag.APM_AudioPolicyManager VERBOSE"
        "log.tag.APM_ClientDescriptor VERBOSE"
        "log.tag.AT VERBOSE"
        "log.tag.AccountManager VERBOSE"
        "log.tag.ActivityManager VERBOSE"
        "log.tag.ActivityManagerService VERBOSE"
        "log.tag.ActivityTaskManager VERBOSE"
        "log.tag.ActivityTaskManagerService VERBOSE"
        "log.tag.AdnRecord VERBOSE"
        "log.tag.AdnRecordCache VERBOSE"
        "log.tag.AdnRecordLoader VERBOSE"
        "log.tag.AirplaneHandler VERBOSE"
        "log.tag.AlarmManager VERBOSE"
        "log.tag.AlarmManagerService VERBOSE"
        "log.tag.AndroidRuntime VERBOSE"
        "log.tag.AppOps VERBOSE"
        "log.tag.AudioAttributes VERBOSE"
        "log.tag.AudioEffect VERBOSE"
        "log.tag.AudioFlinger VERBOSE"
        "log.tag.AudioFlinger::DeviceEffectProxy VERBOSE"
        "log.tag.AudioFlinger::DeviceEffectProxy::ProxyCallback VERBOSE"
        "log.tag.AudioFlinger::EffectBase VERBOSE"
        "log.tag.AudioFlinger::EffectChain VERBOSE"
        "log.tag.AudioFlinger::EffectHandle VERBOSE"
        "log.tag.AudioFlinger::EffectModule VERBOSE"
        "log.tag.AudioFlinger_Threads VERBOSE"
        "log.tag.AudioHwDevice VERBOSE"
        "log.tag.AudioManager VERBOSE"
        "log.tag.AudioPolicy VERBOSE"
        "log.tag.AudioPolicyEffects VERBOSE"
        "log.tag.AudioPolicyIntefaceImpl VERBOSE"
        "log.tag.AudioPolicyManager VERBOSE"
        "log.tag.AudioPolicyService VERBOSE"
        "log.tag.AudioProductStrategy VERBOSE"
        "log.tag.AudioRecord VERBOSE"
        "log.tag.AudioService VERBOSE"
        "log.tag.AudioSystem VERBOSE"
        "log.tag.AudioTrack VERBOSE"
        "log.tag.AudioTrackShared VERBOSE"
        "log.tag.AudioVolumeGroup VERBOSE"
        "log.tag.BackupManager VERBOSE"
        "log.tag.BatteryManager VERBOSE"
        "log.tag.BatteryStatsService VERBOSE"
        "log.tag.BluetoothAdapter VERBOSE"
        "log.tag.BluetoothDevice VERBOSE"
        "log.tag.BluetoothGattService VERBOSE"
        "log.tag.BluetoothHidService VERBOSE"
        "log.tag.BluetoothManager VERBOSE"
        "log.tag.BluetoothMapService VERBOSE"
        "log.tag.BluetoothPanService VERBOSE"
        "log.tag.BluetoothPbapService VERBOSE"
        "log.tag.BluetoothSapService VERBOSE"
        "log.tag.BluetoothService VERBOSE"
        "log.tag.BluetoothSocket VERBOSE"
        "log.tag.BufferQueueDump VERBOSE"
        "log.tag.BufferQueueProducer VERBOSE"
        "log.tag.C2K_AT VERBOSE"
        "log.tag.C2K_ATConfig VERBOSE"
        "log.tag.C2K_RILC VERBOSE"
        "log.tag.CAM2PORT_ VERBOSE"
        "log.tag.CapaSwitch VERBOSE"
        "log.tag.CarrierExpressServiceImpl VERBOSE"
        "log.tag.CarrierExpressServiceImplExt VERBOSE"
        "log.tag.ClipboardManager VERBOSE"
        "log.tag.ConnectivityManager VERBOSE"
        "log.tag.ConnectivityService VERBOSE"
        "log.tag.ConsumerIrService VERBOSE"
        "log.tag.ContentManager VERBOSE"
        "log.tag.CountryDetector VERBOSE"
        "log.tag.DMC-ApmService VERBOSE"
        "log.tag.DMC-Core VERBOSE"
        "log.tag.DMC-DmcService VERBOSE"
        "log.tag.DMC-EventsSubscriber VERBOSE"
        "log.tag.DMC-ReqQManager VERBOSE"
        "log.tag.DMC-SessionManager VERBOSE"
        "log.tag.DMC-TranslatorLoader VERBOSE"
        "log.tag.DMC-TranslatorUtils VERBOSE"
        "log.tag.DSSelector VERBOSE"
        "log.tag.DSSelectorOP01 VERBOSE"
        "log.tag.DSSelectorOP02 VERBOSE"
        "log.tag.DSSelectorOP09 VERBOSE"
        "log.tag.DSSelectorOP18 VERBOSE"
        "log.tag.DSSelectorOm VERBOSE"
        "log.tag.DSSelectorUtil VERBOSE"
        "log.tag.DataDispatcher VERBOSE"
        "log.tag.DeviceIdleController VERBOSE"
        "log.tag.DevicePolicyManager VERBOSE"
        "log.tag.DevicePolicyManagerService VERBOSE"
        "log.tag.DisplayManager VERBOSE"
        "log.tag.DisplayManagerService VERBOSE"
        "log.tag.DockObserver VERBOSE"
        "log.tag.DownloadManager VERBOSE"
        "log.tag.ExternalSimMgr VERBOSE"
        "log.tag.FastCapture VERBOSE"
        "log.tag.FastMixer VERBOSE"
        "log.tag.FastMixerState VERBOSE"
        "log.tag.FastThread VERBOSE"
        "log.tag.FragmentManager VERBOSE"
        "log.tag.FuseDaemon VERBOSE"
        "log.tag.GAv4 VERBOSE"
        "log.tag.GraphicsStats VERBOSE"
        "log.tag.GsmCallTkrHlpr VERBOSE"
        "log.tag.GsmCdmaConn VERBOSE"
        "log.tag.GsmCdmaPhone VERBOSE"
        "log.tag.HardwarePropertiesManager VERBOSE"
        "log.tag.HardwareService VERBOSE"
        "log.tag.IAudioFlinger VERBOSE"
        "log.tag.IMSRILRequest VERBOSE"
        "log.tag.IMS_RILA VERBOSE"
        "log.tag.IccCardProxy VERBOSE"
        "log.tag.IccPhoneBookIM VERBOSE"
        "log.tag.IccProvider VERBOSE"
        "log.tag.ImsApp VERBOSE"
        "log.tag.ImsBaseCommands VERBOSE"
        "log.tag.ImsCall VERBOSE"
        "log.tag.ImsCallProfile VERBOSE"
        "log.tag.ImsCallSession VERBOSE"
        "log.tag.ImsEcbm VERBOSE"
        "log.tag.ImsEcbmProxy VERBOSE"
        "log.tag.ImsManager VERBOSE"
        "log.tag.ImsPhone VERBOSE"
        "log.tag.ImsPhoneBase VERBOSE"
        "log.tag.ImsPhoneCall VERBOSE"
        "log.tag.ImsService VERBOSE"
        "log.tag.ImsVTProvider VERBOSE"
        "log.tag.InputDispatcher VERBOSE"
        "log.tag.InputManager VERBOSE"
        "log.tag.InputManagerService VERBOSE"
        "log.tag.InputMethodManager VERBOSE"
        "log.tag.InputMethodManagerService VERBOSE"
        "log.tag.InterfaceManager VERBOSE"
        "log.tag.IsimFileHandler VERBOSE"
        "log.tag.IsimRecords VERBOSE"
        "log.tag.JobScheduler VERBOSE"
        "log.tag.KeyguardManager VERBOSE"
        "log.tag.LCM-Subscriber VERBOSE"
        "log.tag.LIBC2K_RIL VERBOSE"
        "log.tag.LocationManager VERBOSE"
        "log.tag.LocationManagerService VERBOSE"
    )
    for commands in "${disable_log[@]}"; do
    IFS=' ' read -r name value <<< "$commands"
    setprop "$name" "$value"
done
setprop debug.min.fling_velocity 25000
setprop debug.max.fling_velocity 25000
settings put secure pointer_speed 7
settings put system touch_slop 8
settings put system peak_refresh_rate "$refresh_rate"
settings put system max_refresh_rate "$refresh_rate"
settings put system min_refresh_rate "$refresh_rate"
settings put system miui_refresh_rate "$refresh_rate"
settings put global low_power 0
setprop debug.hwui.renderer skiavk
setprop debug.gpu.renderer skiavk
am kill-all
settings put system POWER_PERFORMANCE_MODE_OPEN 1
cmd activity kill-all

packages=$(cmd package list packages | cut -d ':' -f2 | grep -Ei 'freefire' | sort -u)
for pkg in $packages; do
  cmd package compile -m verify -f "$pkg"
  cmd package compile -m assume-verified -f "$pkg"
  cmd package compile -m everything -f "$pkg"
  cmd package compile -m speed-profile -f "$pkg"
done

}> /dev/null 2>&1
echo ""
echo "[MAIN] $(date '+%H:%M:%S'): Tăng tốc cảm ứng và phản hồi ui "
echo "[MAIN] $(date '+%H:%M:%S'): Dọn Dẹp Bộ Nhớ "
echo "[MAIN] $(date '+%H:%M:%S'): Tối ưu biên dịch "
echo "[MAIN] $(date '+%H:%M:%S'): Tinh chỉnh log hệ thống "
echo "[MAIN] $(date '+%H:%M:%S'): Tùy chọn nâng cao cho GPU renderer"
echo "[MAIN] $(date '+%H:%M:%S'): Khoá Tần Số Quét "

echo "[✔] All modules executed – Optimization Complete!"
apply_fps
tweaks